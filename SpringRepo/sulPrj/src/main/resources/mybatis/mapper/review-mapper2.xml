<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="ReviewMapper">

	<select id="adminList">
	SELECT 
	    R.REVIEW_NO
	    , M.NICK
	    , R.RATING
	    , P.PRODUCT_NO
	    , P.NAME
	    , TO_CHAR (R.ENROLL_DATE, 'YYYY-MM-DD') AS ENROLL_DATE
	    , R.DEL_YN
	FROM REVIEW R
	JOIN MEMBER M ON M.MEMBER_NO = R.MEMBER_NO
	JOIN ORDERS_LIST L ON L.ORDER_LIST_NO = R.ORDER_LIST_NO
	JOIN ORDERS O ON O.ORDER_NO = L.ORDER_NO
	JOIN PRODUCT P ON P.PRODUCT_NO = O.PRODUCT_NO
	ORDER BY REVIEW_NO DESC
	</select>
	
	<select id="adminDetail">
	SELECT 
	    R.REVIEW_NO
	    , R.RATING
	    , M.NICK
	    , P.NAME
	    , TO_CHAR (R.ENROLL_DATE, 'YYYY-MM-DD') AS ENROLL_DATE   
	    , R.DEL_YN
	    , R.IMG
	    , R.CONTENT
	FROM REVIEW R
	JOIN MEMBER M ON M.MEMBER_NO = R.MEMBER_NO
	JOIN ORDERS_LIST L ON L.ORDER_LIST_NO = R.ORDER_LIST_NO
	JOIN ORDERS O ON O.ORDER_NO = L.ORDER_NO
	JOIN PRODUCT P ON P.PRODUCT_NO = O.PRODUCT_NO
	WHERE R.REVIEW_NO = #{reviewNo}
	</select>
	
	<update id="adminDelete">
	UPDATE REVIEW SET DEL_YN = 'Y'
	WHERE REVIEW_NO = #{reviewNo}
	</update>
	
</mapper>